<!DOCTYPE html>
<html lang="fr" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compte-rendu TP 8 - Circuit RC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Configuration Tailwind pour le mode sombre par classe
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <!-- Bibliothèque MathJax pour l'affichage des formules mathématiques -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; scroll-behavior: smooth; transition: background-color 0.3s, color 0.3s; }
        .math { color: #2563eb; }
        .dark .math { color: #60a5fa; }
        .chart-container { position: relative; height: 450px; width: 100%; }
        /* Scrollbar personnalisée pour le tableau horizontal */
        .custom-scrollbar::-webkit-scrollbar { height: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb { background: #475569; }
        @media (max-width: 640px) { .chart-container { height: 350px; } }
    </style>
</head>
<body class="bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-100 leading-relaxed">

    <!-- Bouton Theme Toggle -->
    <div class="fixed top-4 right-4 z-50">
        <button id="themeToggle" class="p-3 rounded-full bg-white dark:bg-slate-800 shadow-lg border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:scale-110 transition-transform">
            <svg id="sunIcon" class="w-6 h-6 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 9H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
            <svg id="moonIcon" class="w-6 h-6 dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
        </button>
    </div>

    <div class="max-w-4xl mx-auto px-4 py-12">
        <!-- Header -->
        <header class="mb-12 border-b border-slate-200 dark:border-slate-800 pb-8 text-center">
            <h1 class="text-4xl font-extrabold text-slate-900 dark:text-white mb-4">Compte-rendu de Physique - TP 8</h1>
            <p class="text-xl text-blue-600 dark:text-blue-400 font-medium italic">Étude de la charge et de la décharge d'un condensateur</p>
            <div class="mt-6 flex justify-center gap-4 text-sm font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                <span>BTS CIEL 1ère Année</span>
                <span>•</span>
                <span>Circuit RC</span>
            </div>
        </header>

        <!-- Objectifs -->
        <section class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 mb-8">
            <h2 class="text-2xl font-bold mb-4 flex items-center text-slate-900 dark:text-white">
                <span class="w-2 h-8 bg-blue-600 rounded-full mr-3"></span>Objectifs
            </h2>
            <p>Étude expérimentale d'un circuit RC, mesure de la constante de temps $\tau$ et vérification des relations fondamentales $i = C \cdot \frac{du_c}{dt}$ et $q = C \cdot u_c$.</p>
        </section>

        <!-- I. Étude Qualitative -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold mb-6 text-slate-900 dark:text-white border-l-4 border-blue-600 pl-4">I. Étude Qualitative</h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white dark:bg-slate-800 p-6 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700">
                    <h3 class="font-bold text-blue-700 dark:text-blue-400 mb-3 uppercase text-sm tracking-widest">1. Charge (Pos. 1)</h3>
                    <ul class="space-y-2 text-sm">
                        <li><span class="font-semibold">Électrons :</span> Flux de l'armature A ($q_A > 0$) vers l'armature B ($q_B < 0$).</li>
                        <li><span class="font-semibold">Stockage :</span> Tension maintenue hors circuit grâce au diélectrique.</li>
                        <li><span class="font-semibold">Fin de charge :</span> Courant nul ($i=0$) quand $u_c = E$.</li>
                    </ul>
                </div>
                <div class="bg-white dark:bg-slate-800 p-6 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700">
                    <h3 class="font-bold text-blue-700 dark:text-blue-400 mb-3 uppercase text-sm tracking-widest">2. Décharge (Pos. 2)</h3>
                    <ul class="space-y-2 text-sm">
                        <li><span class="font-semibold">Évolution :</span> $u_c$ chute vers $0\text{V}$.</li>
                        <li><span class="font-semibold">Courant :</span> Inversion du sens ($i < 0$) pour rétablir la neutralité.</li>
                        <li><span class="font-semibold">Court-circuit :</span> Décharge instantanée si $R \approx 0$ ($\tau \approx 0$).</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- II. Schéma et Montage -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold mb-6 text-slate-900 dark:text-white border-l-4 border-blue-600 pl-4">II. Schéma et Montage</h2>
            <div class="bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-md border border-slate-100 dark:border-slate-700 text-center">
                <img src="Tremendous Lahdi-Densor.png" alt="Montage expérimental réel" class="rounded-xl mx-auto max-h-[500px] shadow-sm mb-4 filter dark:brightness-90">
                <p class="text-sm text-slate-500 dark:text-slate-400 italic mt-2">Figure 1 : Montage réalisé sur Tinkercad</p>
            </div>
        </section>

        <!-- III. Courbe Expérimentale -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold mb-6 text-slate-900 dark:text-white border-l-4 border-blue-600 pl-4">III. Courbe Expérimentale</h2>
            <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700">
                <div class="chart-container">
                    <canvas id="rcChart"></canvas>
                </div>
                <div class="mt-4 flex flex-wrap justify-center gap-6 text-sm font-medium">
                    <span class="flex items-center"><span class="w-3 h-3 bg-blue-600 dark:bg-blue-500 rounded-full mr-2"></span> Tension $u_c$ (V)</span>
                    <span class="flex items-center"><span class="w-3 h-3 bg-red-500 dark:bg-red-400 rounded-full mr-2"></span> Intensité $i$ (µA)</span>
                </div>
            </div>
        </section>

        <!-- IV. Tableau Horizontal -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold mb-6 text-slate-900 dark:text-white border-l-4 border-blue-600 pl-4">IV. Tableau des mesures (Données Sheet2)</h2>
            <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden">
                <div class="overflow-x-auto custom-scrollbar">
                    <table class="w-full text-left border-collapse min-w-max">
                        <tbody class="text-sm">
                            <tr id="rowT" class="border-b border-slate-100 dark:border-slate-700">
                                <th class="p-4 bg-slate-50 dark:bg-slate-900/50 text-slate-600 dark:text-slate-400 font-bold uppercase text-xs border-r border-slate-100 dark:border-slate-700 sticky left-0 z-10">Temps $t$ (s)</th>
                            </tr>
                            <tr id="rowUc" class="border-b border-slate-100 dark:border-slate-700">
                                <th class="p-4 bg-slate-50 dark:bg-slate-900/50 text-slate-600 dark:text-slate-400 font-bold uppercase text-xs border-r border-slate-100 dark:border-slate-700 sticky left-0 z-10">Tension $u_c$ (V)</th>
                            </tr>
                            <tr id="rowI" class="border-b border-slate-100 dark:border-slate-700">
                                <th class="p-4 bg-slate-50 dark:bg-slate-900/50 text-slate-600 dark:text-slate-400 font-bold uppercase text-xs border-r border-slate-100 dark:border-slate-700 sticky left-0 z-10">Intensité $i$ (µA)</th>
                            </tr>
                            <tr id="rowP">
                                <th class="p-4 bg-slate-50 dark:bg-slate-900/50 text-slate-600 dark:text-slate-400 font-bold uppercase text-xs border-r border-slate-100 dark:border-slate-700 sticky left-0 z-10">Phase</th>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <p class="mt-2 text-[10px] text-slate-400 italic text-right">Faites défiler horizontalement pour voir toutes les mesures.</p>
        </section>

        <!-- V. Analyse et Calculs -->
        <section class="grid md:grid-cols-2 gap-8 mb-12">
            <div class="bg-blue-600 dark:bg-blue-700 text-white p-8 rounded-3xl shadow-xl">
                <h2 class="text-xl font-bold mb-6 uppercase tracking-wider">Paramètres fixes</h2>
                <ul class="space-y-4 font-medium">
                    <li class="flex justify-between border-b border-blue-500 pb-2"><span>Générateur ($E$)</span> <span>$8,00\text{ V}$</span></li>
                    <li class="flex justify-between border-b border-blue-500 pb-2"><span>Résistance ($R$)</span> <span>$10\text{ k}\Omega$</span></li>
                    <li class="flex justify-between border-b border-blue-500 pb-2"><span>Capacité ($C$)</span> <span>$4700\text{ }\mu\text{F}$</span></li>
                </ul>
                <div class="mt-8 p-4 bg-white/10 rounded-xl text-sm italic">
                    Vérification Loi des Mailles : $E = u_c + R \cdot i$<br>
                    À $t=40\text{s}$ : $4,58 + (10000 \cdot 342 \cdot 10^{-6}) = 8,00\text{V}$
                </div>
            </div>

            <div class="bg-white dark:bg-slate-800 p-8 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700">
                <h2 class="text-xl font-bold mb-6 text-slate-900 dark:text-white uppercase tracking-wider">Constante de temps $\tau$</h2>
                <div class="space-y-4">
                    <div class="p-4 bg-slate-50 dark:bg-slate-900 rounded-xl border-l-4 border-green-500">
                        <span class="block text-xs font-bold text-slate-400 uppercase">Mesure Graphique (63%)</span>
                        <span class="text-lg font-bold">$\approx 47,0\text{ s}$</span>
                    </div>
                    <div class="p-4 bg-slate-50 dark:bg-slate-900 rounded-xl border-l-4 border-blue-600">
                        <span class="block text-xs font-bold text-slate-400 uppercase">Calcul Théorique ($R \cdot C$)</span>
                        <span class="text-lg font-bold text-blue-600 dark:text-blue-400">$47,0\text{ s}$</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="bg-slate-900 dark:bg-black text-slate-300 dark:text-slate-500 p-10 rounded-3xl mt-12">
            <div class="max-w-2xl mx-auto text-center text-slate-400">
                <h3 class="text-white font-bold mb-4 uppercase text-sm tracking-widest">Synthèse</h3>
                <p class="text-sm mb-4 italic">
                    La relation $i = C \cdot \frac{du_c}{dt}$ est validée par l'allure des courbes expérimentales. 
                    L'intensité du courant est directement proportionnelle à la vitesse de variation de la tension aux bornes du condensateur.
                </p>
                <div class="h-px bg-slate-700 w-24 mx-auto my-6"></div>
                <p class="text-[10px] uppercase tracking-widest">Compte-rendu de Physique - TP 8</p>
            </div>
        </footer>
    </div>

    <script>
        // Gestion du Theme
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;

        themeToggle.addEventListener('click', () => {
            html.classList.toggle('dark');
            updateChartTheme();
        });

        // Données réelles extraites de Sheet2
        const rawData = [
            { t: 0, uc: 0, i: 800, p: "Charge" },
            { t: 10, uc: 1.54, i: 646, p: "Charge" },
            { t: 20, uc: 2.80, i: 520, p: "Charge" },
            { t: 30, uc: 3.82, i: 418, p: "Charge" },
            { t: 40, uc: 4.58, i: 342, p: "Charge" },
            { t: 50, uc: 5.24, i: 276, p: "Charge" },
            { t: 60, uc: 5.78, i: 221, p: "Charge" },
            { t: 80, uc: 6.54, i: 146, p: "Charge" },
            { t: 100, uc: 7.03, i: 97, p: "Charge" },
            { t: 120, uc: 7.36, i: 64, p: "Charge" },
            { t: 140, uc: 7.57, i: 43, p: "Charge" },
            { t: 180, uc: 7.81, i: 19, p: "Charge" },
            { t: 220, uc: 7.92, i: 8, p: "Charge" },
            { t: 230, uc: 6.42, i: -641, p: "Décharge" },
            { t: 240, uc: 5.16, i: -515, p: "Décharge" },
            { t: 250, uc: 4.19, i: -418, p: "Décharge" },
            { t: 260, uc: 3.39, i: -338, p: "Décharge" },
            { t: 270, uc: 2.74, i: -273, p: "Décharge" },
            { t: 300, uc: 1.45, i: -144, p: "Décharge" },
            { t: 350, uc: 0.50, i: -50, p: "Décharge" },
            { t: 400, uc: 0.17, i: -17, p: "Décharge" }
        ];

        const rowT = document.getElementById('rowT');
        const rowUc = document.getElementById('rowUc');
        const rowI = document.getElementById('rowI');
        const rowP = document.getElementById('rowP');

        const labels = [];
        const ucValues = [];
        const iValues = [];

        rawData.forEach(d => {
            labels.push(d.t);
            ucValues.push(d.uc);
            iValues.push(d.i);

            // Remplissage horizontal du tableau (colonnes de données pour chaque ligne variable)
            rowT.innerHTML += `<td class="p-4 border-r border-slate-100 dark:border-slate-700 text-center font-medium min-w-[70px]">${d.t}</td>`;
            rowUc.innerHTML += `<td class="p-4 border-r border-slate-100 dark:border-slate-700 text-center text-blue-600 dark:text-blue-400 font-bold min-w-[70px]">${d.uc.toFixed(2)}</td>`;
            rowI.innerHTML += `<td class="p-4 border-r border-slate-100 dark:border-slate-700 text-center text-red-500 dark:text-red-400 min-w-[70px]">${d.i}</td>`;
            rowP.innerHTML += `<td class="p-4 border-r border-slate-100 dark:border-slate-700 text-center min-w-[70px]">
                <span class="px-2 py-0.5 rounded-full text-[9px] font-bold uppercase ${d.p === 'Charge' ? 'bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-300' : 'bg-red-100 dark:bg-red-900/40 text-red-600 dark:text-red-300'}">${d.p === 'Charge' ? 'CH' : 'DÉ'}</span>
            </td>`;
        });

        // Graphique Chart.js
        const ctx = document.getElementById('rcChart').getContext('2d');
        let chartInstance = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Tension Uc (V)',
                        data: ucValues,
                        borderColor: '#2563eb',
                        backgroundColor: 'rgba(37, 99, 235, 0.1)',
                        borderWidth: 3,
                        yAxisID: 'y',
                        tension: 0.4,
                        pointRadius: 4,
                        fill: true
                    },
                    {
                        label: 'Intensité i (µA)',
                        data: iValues,
                        borderColor: '#ef4444',
                        borderDash: [5, 5],
                        borderWidth: 2,
                        yAxisID: 'y1',
                        tension: 0.4,
                        pointRadius: 3
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                plugins: {
                    legend: { display: false },
                    tooltip: { backgroundColor: '#1e293b', padding: 12 }
                },
                scales: {
                    x: { 
                        title: { display: true, text: 'Temps (s)', font: { weight: 'bold' } },
                        ticks: { color: '#64748b' },
                        grid: { color: 'rgba(100, 116, 139, 0.1)' }
                    },
                    y: { 
                        type: 'linear', display: true, position: 'left',
                        title: { display: true, text: 'Tension (V)', font: { weight: 'bold' } },
                        ticks: { color: '#64748b' },
                        grid: { color: 'rgba(100, 116, 139, 0.1)' },
                        min: 0, max: 9
                    },
                    y1: {
                        type: 'linear', display: true, position: 'right',
                        title: { display: true, text: 'Intensité (µA)', font: { weight: 'bold' } },
                        ticks: { color: '#64748b' },
                        grid: { drawOnChartArea: false },
                        min: -850, max: 850
                    }
                }
            }
        });

        function updateChartTheme() {
            const isDark = html.classList.contains('dark');
            const color = isDark ? '#94a3b8' : '#64748b';
            const gridColor = isDark ? 'rgba(255, 255, 255, 0.05)' : 'rgba(100, 116, 139, 0.1)';

            chartInstance.options.scales.x.ticks.color = color;
            chartInstance.options.scales.x.title.color = isDark ? '#f8fafc' : '#1e293b';
            chartInstance.options.scales.x.grid.color = gridColor;

            chartInstance.options.scales.y.ticks.color = color;
            chartInstance.options.scales.y.title.color = isDark ? '#f8fafc' : '#1e293b';
            chartInstance.options.scales.y.grid.color = gridColor;

            chartInstance.options.scales.y1.ticks.color = color;
            chartInstance.options.scales.y1.title.color = isDark ? '#f8fafc' : '#1e293b';
            
            chartInstance.update();
        }

        // Init thème graphique au chargement
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            html.classList.add('dark');
            updateChartTheme();
        }
    </script>
</body>
</html>
